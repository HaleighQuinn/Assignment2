"0","library(tidycensus)"
"0","library(dplyr)"
"0","library(tigris)"
"0",""
"0","ca_pums <- readRDS(""ca_pums.rds"")"
"0",""
"0","ca_pumas <-"
"0","  pumas(""CA"", cb = T, progress_bar = F)"
"2","Using FIPS code '06' for state 'CA'
"
"0","# Filtering to Bay Pumas:"
"0",""
"0","ca_counties <- counties(""CA"", cb = T, progress_bar = F)"
"2","Using FIPS code '06' for state 'CA'
"
"0","st_crs(ca_counties)"
"1","Coordinate Reference System:"
"1","
"
"1","  User input:"
"1"," "
"1","NAD83"
"1"," "
"1","
"
"1","  wkt:
"
"1",""
"1","GEOGCRS[""NAD83"",
    DATUM[""North American Datum 1983"",
        ELLIPSOID[""GRS 1980"",6378137,298.257222101,
            LENGTHUNIT[""metre"",1]]],
    PRIMEM[""Greenwich"",0,
        ANGLEUNIT[""degree"",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[""latitude"",north,
            ORDER[1],
            ANGLEUNIT[""degree"",0.0174532925199433]],
        AXIS[""longitude"",east,
            ORDER[2],
            ANGLEUNIT[""degree"",0.0174532925199433]],
    ID[""EPSG"",4269]]"
"1",""
"1","
"
"0","projection <- ""+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"""
"0",""
"0","ca_counties_transformed <- "
"0","  ca_counties %>% "
"0","  st_transform(4326) %>% "
"0","  st_transform(26910) %>% "
"0","  st_transform(projection) %>% "
"0","  st_transform(st_crs(ca_counties))"
"0",""
"0","usa_zips <- "
"0","  zctas(cb = T, progress_bar = F)"
"2","ZCTAs can take several minutes to download.  To cache the data and avoid re-downloading in future R sessions, set `options(tigris_use_cache = TRUE)`
"
"0","bay_county_names <-"
"0","  c("
"0","    ""Alameda"","
"0","    ""Contra Costa"","
"0","    ""Marin"","
"0","    ""Napa"","
"0","    ""San Francisco"","
"0","    ""San Mateo"","
"0","    ""Santa Clara"","
"0","    ""Solano"","
"0","    ""Sonoma"""
"0","  )"
"0",""
"0",""
"0","sc_counties <-"
"0","  ca_counties %>%"
"0","  filter(NAME %in% ""Santa Clara"")"
"0",""
"0","library(mapview)"
"0",""
"0","sc_pumas <-"
"0","  ca_pumas %>% "
"0","  st_centroid() %>% "
"0","  .[sc_counties, ] %>% "
"0","  st_set_geometry(NULL) %>% "
"0","  left_join(ca_pumas %>% select(GEOID10)) %>% "
"0","  st_as_sf()"
"2","st_centroid assumes attributes are constant over geometries of x"
"2","st_centroid does not give correct centroids for longitude/latitude data"
"2","although coordinates are longitude/latitude, st_intersects assumes that they are planar
"
"2","although coordinates are longitude/latitude, st_intersects assumes that they are planar
"
"2","Joining, by = ""GEOID10""
"
"0","sc_pums <-"
"0","  ca_pums %>% "
"0","  filter(PUMA %in% sc_pumas$PUMACE10)"
"0",""
"0",""
"0","perc_internetacc <- "
"0","  sc_pums %>% "
"0","  mutate(SCHG = as.numeric(SCHG)) %>% "
"0","  filter (SCHG %in% c(2:14)) %>% "
"0","  mutate("
"0","    no_internetacc = ifelse("
"0","      (ACCESS == ""3""), "
"0","      WGTP, "
"0","      0"
"0","    )"
"0","  ) %>% "
"0","  group_by(PUMA) %>% "
"0","  summarize("
"0","    perc_no_internetacc ="
"0","      sum(no_internetacc, na.rm =T)/sum(WGTP, na.rm = T)*100"
"0","  ) %>% "
"0","  left_join("
"0","    sc_pumas %>% "
"0","      select(PUMACE10),"
"0","    by = c(""PUMA"" = ""PUMACE10"")"
"0","  ) %>% "
"0","  st_as_sf()"
"2","Problem with `mutate()` input `SCHG`.
[34mi[39m NAs introduced by coercion
[34mi[39m Input `SCHG` is `as.numeric(SCHG)`."
"2","NAs introduced by coercion"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"0","  totalperc_nointernet <-"
"0","    perc_internetacc "
"0","    sum(totalperc_nointernet$perc_no_internetacc)"
"1","[1]"
"1"," 38.54034"
"1","
"
"0","    "
"0","    # 38.54% of students grades K-12 don't have access to internet in Santa Clara."
"0","    "
"0","  sum_internetacc <- "
"0","  sc_pums %>% "
"0","  mutate(SCHG = as.numeric(SCHG)) %>% "
"0","  filter (SCHG %in% c(2:14)) %>% "
"0","  mutate("
"0","    no_internetacc = ifelse("
"0","      (ACCESS == ""3""), "
"0","      WGTP, "
"0","      0"
"0","    )"
"0","  ) %>% "
"0","  group_by(PUMA) %>% "
"0","  summarize("
"0","    sum_no_internetacc ="
"0","      sum(no_internetacc, na.rm =T)"
"0","  ) %>% "
"0","  left_join("
"0","    sc_pumas %>% "
"0","      select(PUMACE10),"
"0","    by = c(""PUMA"" = ""PUMACE10"")"
"0","  ) %>% "
"0","  st_as_sf()"
"2","Problem with `mutate()` input `SCHG`.
[34mi[39m NAs introduced by coercion
[34mi[39m Input `SCHG` is `as.numeric(SCHG)`."
"2","NAs introduced by coercion"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"0","  "
"0","  total_nointernet <-"
"0","    sum_internetacc"
"0","    sum(total_nointernet$sum_no_internetacc)"
"1","[1]"
"1"," 7894"
"1","
"
"0","    "
"0","    # 7894 of students grades K-12 don't have access to internet in Santa Clara"
"0",""
"0","# Map Creation: "
"0",""
"0","pums_pal <- colorNumeric("
"0","  palette = ""Purples"","
"0","  domain = perc_internetacc$perc_no_internetacc"
"0",")"
"0",""
"0","leaflet() %>%"
"0","  addTiles() %>% "
"0","  addPolygons("
"0","    data = perc_internetacc,"
"0","    fillColor = ~pums_pal(perc_no_internetacc),"
"0","    color = ""white"","
"0","    opacity = 0.5,"
"0","    fillOpacity = 0.5,"
"0","    weight = 1,"
"0","    label = ~paste0("
"0","      round(perc_no_internetacc), "
"0","      ""% K-12 Students without Internet Access"""
"0","    ),"
"0","    highlightOptions = highlightOptions("
"0","      weight = 2,"
"0","      opacity = 1"
"0","    )"
"0","  ) %>% "
"0","  addLegend("
"0","    data = perc_internetacc,"
"0","    pal = pums_pal,"
"0","    values = ~perc_no_internetacc,"
"0","    title = ""% K-12 Students<br>without Internet Access<br>in Santa Clara County"""
"0","  )"
"2","sf layer has inconsistent datum (+proj=longlat +datum=NAD83 +no_defs).
Need '+proj=longlat +datum=WGS84'"
